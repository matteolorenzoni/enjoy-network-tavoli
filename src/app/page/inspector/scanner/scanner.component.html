<section class="flex flex-col items-center">
  <div class="mb-8 w-full">
    <en-button
      buttonName="scan-button"
      [buttonText]="lblButton"
      buttonType="submit"
      [buttonIsDisabled]="false"
      palette="primary"
      [isLoading]="false"
      (customClick)="onResetParticipation()"></en-button>
  </div>

  <select
    id="countries"
    class="text-smplaceholder-gray-400 mb-8 block w-full rounded-lg border border-slate-700 bg-slate-800 p-2.5 text-white"
    (change)="onDeviceSelectChange($event)">
    <option value="" [selected]="!currentDevice">Nessuna camera</option>
    <option *ngFor="let device of availableDevices" [value]="device.deviceId">{{ device.label }}</option>
  </select>

  <div #cameraContainer class="scanner-container w-full overflow-hidden rounded-lg">
    <zxing-scanner
      [enable]="enabled"
      [device]="currentDevice"
      [formats]="formatsEnabled"
      (camerasFound)="onCamerasFound($event)"
      (permissionResponse)="onHasPermission($event)"
      (camerasFound)="onCamerasFound($event)"
      (camerasNotFound)="onCamerasNotFound()"
      (scanSuccess)="onScanSuccess($event)">
    </zxing-scanner>
  </div>

  <div #errorContainer class="center hidden aspect-square w-full max-w-lg flex-col gap-4 rounded-lg bg-slate-800">
    <fa-icon [icon]="banIcon" class="pb-4 text-8xl text-slate-300"></fa-icon>
    <p class="text-slate-300">{{ lblCameraInfo }}</p>
  </div>

  <div
    *ngIf="participation"
    class="flex h-full min-h-fit w-full flex-col items-center justify-evenly overflow-auto rounded-lg p-4 text-center text-white"
    [ngClass]="{ 'bg-red-500': !isInScanRange, 'bg-emerald-600': isInScanRange }">
    <fa-icon [icon]="isInScanRange ? checkIcon : exclamationIcon" class="pb-4 text-8xl"></fa-icon>
    <p class="max-w-full truncate text-4xl">{{ participation.props.name }}</p>
    <p class="max-w-full truncate text-4xl">{{ participation.props.lastName }}</p>
    <br />
    <p class="max-w-full truncate text-2xl">{{ participation.props.phone }}</p>
    <br />
    <br />
    <p *ngIf="participation.props.scannedAt">
      <span class="font-bold underline">Ora entrata</span> <br />
      {{ participation.props.scannedAt | date: 'HH:mm:ss' }}
    </p>
    <p *ngIf="!isInScanRange">
      <span class="font-bold underline">Motivazione</span> <br />
      {{ participationNoGoodMotivation }}
    </p>
  </div>
</section>
